---
title: '[ì›í‹°ë“œ í”„ë¦¬ì˜¨ë³´ë”© ì±Œë¦°ì§€] useRouter í›…ìœ¼ë¡œ ë¶„ë¦¬í•˜ê¸°'
date: '2023-07-07'
---

> ì´ì „ ê¸€) [[ì›í‹°ë“œ í”„ë¦¬ì˜¨ë³´ë”© ì±Œë¦°ì§€] Reactì—ì„œ History API ì‚¬ìš©í•˜ì—¬ SPA Router ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸°](https://velog.io/@wlwl99/%EC%9B%90%ED%8B%B0%EB%93%9C-%ED%94%84%EB%A6%AC%EC%98%A8%EB%B3%B4%EB%94%A9-%EC%B1%8C%EB%A6%B0%EC%A7%80-React%EC%99%80-History-API-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-SPA-Router-%EA%B8%B0%EB%8A%A5-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0)

`App.js` ì•ˆì— ëª¨ë“  ì½”ë“œë¥¼ ì‘ì„±í–ˆëŠ”ë°, ì´ë¥¼ `Router`, `Route` ì»´í¬ë„ŒíŠ¸, `useRouter()` í›…ìœ¼ë¡œ ë¶„ë¦¬í•˜ë ¤ê³  í•œë‹¤.

```
ğŸ“ src
â¿ ğŸ“„ App.js
â¿ ğŸ“„ index.js
â¿ ğŸ“ component
   â¿ ğŸ“„ Root.js
   â¿ ğŸ“„ About.js
   â¿ ğŸ“„ Router.js
   â¿ ğŸ“„ Route.js
â¿ ğŸ“ hooks
   â¿ ğŸ“„ useRouter.js
```

### index.js

```jsx
const rootElement = document.getElementById('root');
const root = createRoot(rootElement);

root.render(
	<Router>
		<Route path='/' component={<Root />} />
		<Route path='/about' component={<About />} />
	</Router>
);
```

### Router.js

```jsx
function Router({ children }) {
	return children;
}
export default Router;
```

### Route.js

```jsx
function Route({ path, component }) {
	const { currentPath } = useRouter();
	return currentPath === path ? component : null;
	// pathnameì´ /ì´ë¼ë©´ <Home /> ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•œë‹¤.
	// pathnameì´ /aboutì´ë¼ë©´ <About /> ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•œë‹¤.
}

export default Route;
```

### useRouter.js

```jsx
import { useState, useEffect } from 'react';

export const useRouter = () => {
	const [currentPath, setCurrentPath] = useState(window.location.pathname);

	useEffect(() => {
		const handlePopState = () => {
			setCurrentPath(window.location.pathname);
		};

		window.addEventListener('popstate', handlePopState);

		return () => {
			window.removeEventListener('popstate', handlePopState);
		};
	}, []);

	const updateURL = (path) => {
		window.history.pushState(null, '', path);
		setCurrentPath(window.location.pathname);
	};

	return { updateURL, currentPath };
};
```

### About.js

```jsx
import { useRouter } from '../hooks/useRouter';

const About = () => {
	const { updateURL } = useRouter();

	return (
		<div>
			<h1>About</h1>
			<button onClick={() => updateURL('/')}>Homeìœ¼ë¡œ ê°€ê¸°</button>
		</div>
	);
};

export default About;
```

!codesandbox[bold-shadow-38g753?fontsize=14&hidenavigation=1&theme=dark]

ì´ë ‡ê²Œ `useRouter` í›…ìœ¼ë¡œ ë¶„ë¦¬í•˜ê³  ë‚˜ë‹ˆ
"Aboutìœ¼ë¡œ ê°€ê¸°" ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ `updateURL()` í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³ , `currentPath` ìƒíƒœê°€ `'/about'`ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì§€ë§Œ,
`<Root>` ì»´í¬ë„ŒíŠ¸ëŠ” `currentPath` ìƒíƒœë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— ë¦¬ë Œë”ë§ì„ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.

`useRouter` í›…ì˜ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‚´í´ë³´ì.

```jsx
export const useRouter = () => {
	const [currentPath, setCurrentPath] = useState(window.location.pathname);

	useEffect(() => {
		const handlePopState = () => {
			setCurrentPath(window.location.pathname);
		};

		window.addEventListener('popstate', handlePopState);

		return () => {
			window.removeEventListener('popstate', handlePopState);
		};
	}, []);

	const updateURL = (path) => {
		window.history.pushState(null, '', path);
		setCurrentPath(window.location.pathname); // âŒ
	};

	return { updateURL, currentPath };
};
```

ê²½ë¡œì— ë”°ë¥¸ ì•Œë§ì€ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë˜ê²Œ í•˜ë ¤ë©´ popState ì´ë²¤íŠ¸ê°€ ë°œìƒí•´ì•¼ í•œë‹¤.
í•˜ì§€ë§Œ `updateURL()` í•¨ìˆ˜ ë‚´ì—ì„œ `setCurrentPath()`ë¡œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•´ì£¼ë©´, popState ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ì§€ ì•Šê³ , `currentPath` ìƒíƒœê°’ë§Œ ì—…ë°ì´íŠ¸í•´ì£¼ëŠ” ê²ƒì´ë‹¤.

ê·¸ë ‡ë‹¤ë©´ `updateURL()` í•¨ìˆ˜ë¥¼ ì–´ë–»ê²Œ ìˆ˜ì •í•´ì•¼í• ê¹Œ?
X í‘œì‹œí•œ ì¤„ì—ì„œ ì§ì ‘ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ì‹œì¼œì£¼ëŠ” ê²ƒì´ ì•„ë‹Œ popState ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë„ë¡ í•´ì¤˜ì•¼ í•œë‹¤.

### ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ìƒì„±í•˜ê¸°

`new Event()` ìƒì„±ìë¥¼ ì´ìš©í•´ ì´ë²¤íŠ¸ë¥¼ ë§Œë“¤ê³ , `dispatchEvent(event)` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.
[Creating and triggering events](https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events)
[EventTarget.dispatchEvent()](https://developer.mozilla.org/ko/docs/Web/API/EventTarget/dispatchEvent)

```js
const updateURL = (path) => {
	window.history.pushState(null, '', path);
	const event = new Event('popstate'); // ì´ë²¤íŠ¸ ìƒì„±
	dispatchEvent(event); // ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°
};
```

!codesandbox[interesting-architecture-c4fk3r?fontsize=14&hidenavigation=1&theme=dark]

ì´ì œ `updateURL()` í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ url ë³€ê²½ê³¼ popState ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê³ , `currentPath`ê°€ ì—…ë°ì´íŠ¸ë˜ë©° í™”ë©´ì´ ì œëŒ€ë¡œ ë¦¬ë Œë”ë§ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
